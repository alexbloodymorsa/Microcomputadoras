processor 16f877
include<p16f877.inc>

CONTADOR0 EQU 0X20
CONTADOR1 EQU 0X21
VALOR0 EQU 0X22
VALOR1 EQU 0X23

	ORG 0
	GOTO inicio
	ORG 4
	GOTO INTERRUPCIONES

inicio
	BSF STATUS,RP0
	BCF STATUS,RP1
	CLRF TRISB
	CLRF TRISD
	MOVLW B'00000111'
	MOVWF OPTION_REG
	BSF PIE1, TMR1IE

	BCF STATUS,5 
	BCF INTCON, T0IF
	BSF INTCON, T0IE
	BSF INTCON, GIE

	MOVLW B'00110001'
	MOVWF T1CON
	BSF INTCON, PEIE
	CLRF PORTB
	CLRF PORTD
	CLRF CONTADOR0
	CLRF CONTADOR1
	CLRF TMR1H
	CLRF TMR1L
	BCF PIR1, TMR1IF
	GOTO $

INTERRUPCIONES:
	BTFSS INTCON, T0IF
	GOTO TIMER_1
	INCF CONTADOR0
	MOVLW D'19'
	SUBWF CONTADOR0, W 
	BTFSS STATUS, Z
	GOTO SAL_INT0
	CLRF CONTADOR0
	MOVLW 0X99
	SUBWF VALOR0, W 
	BTFSS STATUS, Z
	GOTO INC_VALOR0
	CLRF VALOR0 
	MOVF VALOR0, W 
	MOVWF PORTB

SAL_INT0:
	BCF INTCON, T0IF
	GOTO SAL_NO_TIMER1

TIMER_1:
	BTFSS PIR1, TMR1IF
	GOTO SAL_NO_TIMER1
	INCF CONTADOR1
	MOVLW D'5'
	SUBWF CONTADOR1, W 
	BTFSS STATUS, Z
	GOTO SAL_INT1
	CLRF CONTADOR1
	MOVLW 0X99
	SUBWF VALOR1, W 
	BTFSS STATUS, Z
	GOTO INC_VALOR1
	CLRF VALOR1 
	MOVF VALOR1, W 
	MOVWF PORTB

SAL_INT1:
	BCF PIR1, TMR1IF

SAL_NO_TIMER1: 
	RETFIE

INC_VALOR0:
	MOVF VALOR0, W 
	ANDLW 0X0F
	SUBLW 0X09
	BTFSS STATUS, Z
	GOTO NO_ES_NUEVE0
	GOTO ES_NUEVE0

NO_ES_NUEVE0:
	INCF VALOR0 
	MOVF VALOR0, W 
	MOVWF PORTB
	GOTO SAL_INT0

ES_NUEVE0:
	MOVLW 0X10
	ADDWF VALOR0
	MOVLW 0X09
	SUBWF VALOR0
	MOVF VALOR0, W 
	MOVWF PORTB 
	GOTO SAL_INT0

INC_VALOR1:
	MOVF VALOR1, W 
	ANDLW 0X0F
	SUBLW 0X09
	BTFSS STATUS, Z
	GOTO NO_ES_NUEVE1
	GOTO ES_NUEVE1

NO_ES_NUEVE1:
	INCF VALOR1 
	MOVF VALOR1, W 
	MOVWF PORTD
	GOTO SAL_INT1

ES_NUEVE1:
	MOVLW 0X10
	ADDWF VALOR1
	MOVLW 0X09
	SUBWF VALOR1
	MOVF VALOR1, W 
	MOVWF PORTD
	GOTO SAL_INT1

END
